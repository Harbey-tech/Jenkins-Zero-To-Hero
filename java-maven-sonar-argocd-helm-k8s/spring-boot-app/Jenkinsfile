pipeline {
    agent any

    stages {
        stage('Environment Check') {
            steps {
                sh '''
                    echo "=============== ENVIRONMENT CHECK ==============="
                    echo "Current directory: $(pwd)"
                    echo "Listing files:"
                    ls -al

                    echo "-------------------------------------------------"
                    echo "Java Version:"
                    java -version || true

                    echo "-------------------------------------------------"
                    echo "Maven Version:"
                    mvn -v || true

                    echo "-------------------------------------------------"
                    echo "Checking for pom.xml:"
                    if [ ! -f pom.xml ]; then
                        echo "ERROR: pom.xml not found!"
                        exit 1
                    fi
                '''
            }
        }

        stage('Maven Build (Debug Mode)') {
            steps {
                sh '''
                    echo "=============== MAVEN BUILD START ==============="
                    mvn -X clean install
                '''
            }
        }
    }

    post {
        always {
            echo "=============== PIPELINE FINISHED ==============="
        }
    }
}
